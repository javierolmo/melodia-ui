(self.webpackChunkmelodia_ui=self.webpackChunkmelodia_ui||[]).push([[279],{54779:function(e,t,n){"use strict";n.r(t),n.d(t,{ComposicionModule:function(){return M}});var i=n(38583),s=n(99763),o=n(37716);let r=(()=>{class e{ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-composicion"]],decls:1,vars:0,template:function(e,t){1&e&&o._UZ(0,"router-outlet")},directives:[s.lC],encapsulation:2}),e})();var a=n(55477);class c{constructor(){this.authors=[],this.instrumentos=[]}validate(){return void 0===this.movementTitle?"El t\xedtulo no debe estar vac\xedo":this.movementTitle.length<3?"El t\xedtulo debe tener al menos 3 caracteres":this.movementTitle.length>255?"El t\xedtulo no debe tener m\xe1s de 255 caracteres":void 0===this.measures?"El n\xfamero de compases es obligatorio":this.measures>300?"El n\xfamero de compases no debe exceder de 300":this.measures<30?"El n\xfamero de compases no debe ser inferior a 30":void 0}}var l=n(92340),u=n(91841);let d=(()=>{class e{constructor(e){this.httpClient=e}getAvailableInstruments(){return this.httpClient.get(`${l.N.apiUrl}/api/util/available-instruments`)}getAvailableMeasures(){return this.httpClient.get(`${l.N.apiUrl}/api/util/available-measures`)}getAvailableTonalities(){return this.httpClient.get(`${l.N.apiUrl}/api/util/available-tonalities`)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(u.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})();var p=n(3679),h=n(13030),g=n(91e3);let m=(()=>{class e{constructor(e){this.httpClient=e}getInstruments(){return this.httpClient.get(`${l.N.apiUrl}/api/instruments`)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(u.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})(),f=(()=>{class e{constructor(e){this.httpClient=e}getTonalities(){return this.httpClient.get(`${l.N.apiUrl}/api/tonalities`)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(u.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})(),Z=(()=>{class e{constructor(e){this.httpClient=e}getMeasures(){return this.httpClient.get(`${l.N.apiUrl}/api/measures`)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(u.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})();var b=n(86665),v=n(88002);let T=(()=>{class e{constructor(e){this.httpClient=e}getRandomGeneticSpecs(e){return this.httpClient.get(`${l.N.apiUrl}/api/specs/genetic-specs/random?requesterId=${e}`).pipe((0,v.U)(e=>Object.assign(new c,e)))}postGeneticSpecs(e){return this.httpClient.post(`${l.N.apiUrl}/api/specs/genetic-specs`,e)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(u.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})();function A(e,t){if(1&e&&(o.TgZ(0,"nb-option",17),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e),o.xp6(1),o.Oqu(e.name)}}function q(e,t){if(1&e&&(o.TgZ(0,"nb-option",17),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e),o.xp6(1),o.Oqu(e.traditionalName)}}function y(e,t){if(1&e&&(o.TgZ(0,"nb-option",17),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e),o.xp6(1),o.AsE("",e.numerador,"/",e.denominador,"")}}let w=(()=>{class e{constructor(e,t,n,i,s,o,r,a,l){this.compositionService=e,this.formBuilder=t,this.toastrService=n,this.userService=i,this.instrumentService=s,this.tonalityService=o,this.measureService=r,this.authService=a,this.specsService=l,this.specs=new c,this.authService.onTokenChange().subscribe(e=>{if(e.isValid()){const t=e.getPayload();this.specs.requesterId=t.id,this.specs.authors=[t.name+" "+t.surname]}})}ngOnInit(){this.instrumentService.getInstruments().subscribe(e=>this.availableInstruments=e),this.measureService.getMeasures().subscribe(e=>this.availableMeasures=e),this.tonalityService.getTonalities().subscribe(e=>this.availableTonalities=e)}submit(){const e=this.specs.validate();void 0===e?this.specsService.postGeneticSpecs(this.specs).subscribe(e=>{this.toastrService.success("Tu composici\xf3n se ha puesto a la cola. Dentro de poco estar\xe1 disponible","SUCCESS!")},e=>{this.toastrService.danger(e.error.message,"ERROR")}):this.toastrService.warning(e,"Formulario inv\xe1lido")}randomize(){return e=this,void 0,n=function*(){this.specsService.getRandomGeneticSpecs(this.specs.requesterId).subscribe(e=>this.specs=e,e=>this.toastrService.danger(e.error.message,"ERROR"))},new((t=void 0)||(t=Promise))(function(i,s){function o(e){try{a(n.next(e))}catch(t){s(t)}}function r(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(o,r)}a((n=n.apply(e,[])).next())});var e,t,n}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(d),o.Y36(p.qu),o.Y36(h.quB),o.Y36(g.mt),o.Y36(m),o.Y36(f),o.Y36(Z),o.Y36(b._o),o.Y36(T))},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-composition-request-form"]],decls:37,vars:6,consts:[[1,"row","my-4"],[1,"col","pl-4"],["for","title"],["id","title","type","text","nbInput","","fullWidth","","placeholder","Nombre de la composici\xf3n",3,"ngModel","ngModelChange"],["for","author"],["id","author","type","text","nbInput","","fullWidth","","placeholder","Autor de la obra","disabled","",3,"ngModel","ngModelChange"],["for","measureNumber"],["id","measureNumber","type","text","nbInput","","placeholder","N\xfamero de compases","fullWidth","",3,"ngModel","ngModelChange"],["for","instruments"],["id","instruments","multiple","","formControlName","instrumentos","placeholder","Instrumentos","fullWidth",""],[3,"value",4,"ngFor","ngForOf"],["for","tonality"],["id","tonality","placeholder","Tonalidad","fullWidth",""],["for","measure"],["id","measure","placeholder","Comp\xe1s","fullWidth",""],["nbButton","","status","basic",1,"mx-3",3,"click"],["icon","flip-outline"],[3,"value"]],template:function(e,t){1&e&&(o.TgZ(0,"nb-card"),o.TgZ(1,"nb-card-header"),o._uU(2,"Especificaciones"),o.qZA(),o.TgZ(3,"nb-card-body"),o.TgZ(4,"div",0),o.TgZ(5,"div",1),o.TgZ(6,"label",2),o._uU(7,"T\xedtulo"),o.qZA(),o.TgZ(8,"input",3),o.NdJ("ngModelChange",function(e){return t.specs.movementTitle=e}),o.qZA(),o.qZA(),o.TgZ(9,"div",1),o.TgZ(10,"label",4),o._uU(11,"Autor"),o.qZA(),o.TgZ(12,"input",5),o.NdJ("ngModelChange",function(e){return t.specs.authors[0]=e}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(13,"div",0),o.TgZ(14,"div",1),o.TgZ(15,"label",6),o._uU(16,"Compases"),o.qZA(),o.TgZ(17,"input",7),o.NdJ("ngModelChange",function(e){return t.specs.measures=e}),o.qZA(),o.qZA(),o.TgZ(18,"div",1),o.TgZ(19,"label",8),o._uU(20,"Instrumentos"),o.qZA(),o.TgZ(21,"nb-select",9),o.YNc(22,A,2,2,"nb-option",10),o.qZA(),o.qZA(),o.TgZ(23,"div",1),o.TgZ(24,"label",11),o._uU(25,"Tonalidad"),o.qZA(),o.TgZ(26,"nb-select",12),o.YNc(27,q,2,2,"nb-option",10),o.qZA(),o.qZA(),o.TgZ(28,"div",1),o.TgZ(29,"label",13),o._uU(30,"Comp\xe1s"),o.qZA(),o.TgZ(31,"nb-select",14),o.YNc(32,y,2,3,"nb-option",10),o.qZA(),o.qZA(),o.qZA(),o.TgZ(33,"button",15),o.NdJ("click",function(){return t.submit()}),o._uU(34,"Componer!"),o.qZA(),o.TgZ(35,"button",15),o.NdJ("click",function(){return t.randomize()}),o._UZ(36,"nb-icon",16),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(8),o.Q6J("ngModel",t.specs.movementTitle),o.xp6(4),o.Q6J("ngModel",t.specs.authors[0]),o.xp6(5),o.Q6J("ngModel",t.specs.measures),o.xp6(5),o.Q6J("ngForOf",t.availableInstruments),o.xp6(5),o.Q6J("ngForOf",t.availableTonalities),o.xp6(5),o.Q6J("ngForOf",t.availableMeasures))},directives:[h.Asz,h.ndF,h.yKW,h.h8i,p.Fj,p.JJ,p.On,h.rs,p.u,i.sg,h.DPz,h.fMN,h.q51],styles:[""]}),e})(),x=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-genetic"]],decls:1,vars:0,template:function(e,t){1&e&&o._UZ(0,"ngx-composition-request-form")},directives:[w],styles:[""]}),e})(),_=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-introduccion"]],decls:2,vars:0,template:function(e,t){1&e&&(o.TgZ(0,"p"),o._uU(1,"introduccion works!"),o.qZA())},styles:[""]}),e})(),S=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-generar"]],decls:2,vars:0,template:function(e,t){1&e&&(o.TgZ(0,"p"),o._uU(1,"generar works!"),o.qZA())},styles:[""]}),e})(),U=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-entrenar"]],decls:2,vars:0,template:function(e,t){1&e&&(o.TgZ(0,"p"),o._uU(1,"entrenar works!"),o.qZA())},styles:[""]}),e})();const C=[{path:"",component:r,children:[{path:"genetic",component:x},{path:"neural-network",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["ngx-neuralnetwork"]],decls:9,vars:0,consts:[["tabTitle","Introducci\xf3n"],["tabTitle","Generar"],["tabTitle","Entrenar"]],template:function(e,t){1&e&&(o.TgZ(0,"nb-card"),o.TgZ(1,"nb-card-body"),o.TgZ(2,"nb-tabset"),o.TgZ(3,"nb-tab",0),o._UZ(4,"ngx-introduccion"),o.qZA(),o.TgZ(5,"nb-tab",1),o._UZ(6,"ngx-generar"),o.qZA(),o.TgZ(7,"nb-tab",2),o._UZ(8,"ngx-entrenar"),o.qZA(),o.qZA(),o.qZA(),o.qZA())},directives:[h.Asz,h.yKW,h.kyn,h.TR4,_,S,U],styles:[""]}),e})()},{path:"**",component:a.w}]}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.Bz.forChild(C)],s.Bz]}),e})(),M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[d,m,f,Z,T],imports:[[i.ez,k,p.UX,h.nKr,h.IIj,h.T2N,h.zyh,p.u5,h.LW9,h.EoG,h.KdK]]}),e})()},44519:function(e,t,n){"use strict";n.r(t),n.d(t,{MiscellaneousModule:function(){return l}});var i=n(13030),s=n(10352),o=n(99763),r=n(37716);const a=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-miscellaneous"]],decls:1,vars:0,template:function(e,t){1&e&&r._UZ(0,"router-outlet")},directives:[o.lC],encapsulation:2}),e})(),children:[{path:"404",component:n(55477).w}]}];let c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[o.Bz.forChild(a)],o.Bz]}),e})(),l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[s.O,i.zyh,i.T2N,c]]}),e})()},55477:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var i=n(37716),s=n(13030);let o=(()=>{class e{constructor(e){this.menuService=e}goToHome(){this.menuService.navigateHome()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(s.kkI))},e.\u0275cmp=i.Xpm({type:e,selectors:[["ngx-not-found"]],decls:11,vars:0,consts:[[1,"row"],[1,"col-md-12"],[1,"flex-centered","col-xl-4","col-lg-6","col-md-8","col-sm-12"],[1,"title"],[1,"sub-title"],["nbButton","","matRipple","","fullWidth","","type","button",1,"home-button",3,"click"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"nb-card"),i.TgZ(3,"nb-card-body"),i.TgZ(4,"div",2),i.TgZ(5,"h2",3),i._uU(6,"404 Page Not Found"),i.qZA(),i.TgZ(7,"small",4),i._uU(8,"The page you were looking for doesn't exist"),i.qZA(),i.TgZ(9,"button",5),i.NdJ("click",function(){return t.goToHome()}),i._uU(10," Take me home "),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA())},directives:[s.Asz,s.yKW,s.DPz],styles:[".flex-centered[_ngcontent-%COMP%]{margin:auto}nb-card-body[_ngcontent-%COMP%]{display:flex}.sub-title[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{text-align:center}.sub-title[_ngcontent-%COMP%]{display:block;margin-bottom:3rem}.home-button[_ngcontent-%COMP%]{margin-bottom:2rem}"]}),e})()},70279:function(e,t,n){"use strict";n.r(t),n.d(t,{PagesModule:function(){return w}});var i=n(13030),s=n(99763);const o=[{title:"General",group:!0},{title:"Home",icon:"home",link:"/pages/home",home:!0},{title:"Composici\xf3n",icon:"music-outline",children:[{title:"Gen\xe9tico",link:"/pages/composicion/genetic"},{title:"Red neuronal",link:"/pages/composicion/neural-network"}]},{title:"Mi repositorio",icon:"pantone-outline",link:"/pages/repositorio"},{title:"Administraci\xf3n",icon:"settings-outline",children:[{title:"Usuarios",link:"/pages/admin/users"},{title:"Logs",link:"/pages/admin/logs"}]},{title:"Cuenta",group:!0},{title:"Cerrar sesi\xf3n",icon:"log-out-outline",link:"/auth/logout"}];var r=n(37716),a=n(6405);let c=(()=>{class e{constructor(){this.menu=o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-pages"]],decls:3,vars:1,consts:[[3,"items"]],template:function(e,t){1&e&&(r.TgZ(0,"ngx-one-column-layout"),r._UZ(1,"nb-menu",0),r._UZ(2,"router-outlet"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("items",t.menu))},directives:[a.s,i.mBz,s.lC],styles:[".nb-theme-default   [_nghost-%COMP%]     router-outlet+*{display:block;-webkit-animation:fade 1s;animation:fade 1s}@-webkit-keyframes fade{0%{opacity:0}to{opacity:1}}.nb-theme-dark   [_nghost-%COMP%]     router-outlet+*{display:block;-webkit-animation:fade 1s;animation:fade 1s}.nb-theme-cosmic   [_nghost-%COMP%]     router-outlet+*{display:block;-webkit-animation:fade 1s;animation:fade 1s}.nb-theme-corporate   [_nghost-%COMP%]     router-outlet+*{display:block;-webkit-animation:fade 1s;animation:fade 1s}@keyframes fade{0%{opacity:0}to{opacity:1}}"]}),e})();var l=n(55477),u=n(92340),d=n(19418),p=n(38583);function h(e,t){if(1&e&&(r.TgZ(0,"ul"),r.TgZ(1,"li"),r._uU(2),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.xp6(2),r.Oqu(e)}}function g(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"h6"),r._uU(2),r.qZA(),r.YNc(3,h,3,1,"ul",1),r._UZ(4,"hr"),r.qZA()),2&e){const e=t.$implicit;r.xp6(2),r.AsE("Versi\xf3n ",e.version," (",e.date,")"),r.xp6(1),r.Q6J("ngForOf",e.news)}}let m=(()=>{class e{constructor(e,t){this.releaseService=e,this.toastrService=t,this.releases=[]}ngOnInit(){this.releaseService.getReleases().subscribe(e=>this.releases=e,e=>this.toastrService.danger("Could not load changelog"))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(d.T),r.Y36(i.quB))},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-changelog"]],decls:5,vars:1,consts:[["size","giant"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(r.TgZ(0,"nb-card",0),r.TgZ(1,"nb-card-header"),r._uU(2,"Changelog"),r.qZA(),r.TgZ(3,"nb-card-body"),r.YNc(4,g,5,3,"div",1),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Q6J("ngForOf",t.releases))},directives:[i.Asz,i.ndF,i.yKW,p.sg],styles:[""]}),e})(),f=(()=>{class e{constructor(){this.appname=u.N.appname,this.appversion=u.N.appversion}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-home"]],decls:33,vars:1,consts:[[1,"row"],[1,"col-8"],[2,"font-size","large"],["href","https://jenetics.io/"],["src","/assets/images/scheme.svg","alt","logo",1,"w-100"],[1,"col-4"],["data",r.$Z9`/assets/images/favicon.svg`,1,"w-100",2,"max-height","500px"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"nb-card"),r.TgZ(3,"nb-card-header"),r._uU(4,"INTRODUCCI\xd3N"),r.qZA(),r.TgZ(5,"nb-card-body"),r.TgZ(6,"p"),r.TgZ(7,"strong",2),r._uU(8),r.qZA(),r._uU(9," es un software de composici\xf3n musical elaborado como Proyecto de Fin de Grado en Ingenier\xeda Inform\xe1tica, UNED."),r.qZA(),r.TgZ(10,"p"),r._uU(11,"El objetivo principal es la implementaci\xf3n de un algoritmo evolutivo en un caso real. Para ello se ha utilizado la librer\xeda "),r.TgZ(12,"a",3),r._uU(13,"Jenetics"),r.qZA(),r._uU(14,", disponible en Java."),r.qZA(),r.TgZ(15,"p"),r._uU(16,'En la secci\xf3n "'),r.TgZ(17,"strong"),r._uU(18,"Composici\xf3n"),r.qZA(),r._uU(19,'" podr\xe1s rellenar un formulario de especificaciones para hacer una solicitud, que ser\xe1 recibida por el backend y posteriormente derivada al servicio de composici\xf3n, el responsable de atender la petici\xf3n y elaborar el resultado.'),r.qZA(),r.TgZ(20,"p"),r._uU(21,'Podr\xe1s ver los resultados de las composiciones una vez finalicen en la secci\xf3n "'),r.TgZ(22,"strong"),r._uU(23,"Mi repositorio"),r.qZA(),r._uU(24,'", donde podr\xe1s visualizar y descargar (en formatos .musicxml y .pdf)'),r.qZA(),r.qZA(),r.qZA(),r.TgZ(25,"nb-card"),r.TgZ(26,"nb-card-header"),r._uU(27,"Estructura"),r.qZA(),r.TgZ(28,"nb-card-body"),r._UZ(29,"img",4),r.qZA(),r.qZA(),r.qZA(),r.TgZ(30,"div",5),r._UZ(31,"object",6),r._UZ(32,"ngx-changelog"),r.qZA(),r.qZA()),2&e&&(r.xp6(8),r.Oqu(t.appname))},directives:[i.Asz,i.ndF,i.yKW,m],styles:[""]}),e})();var Z=n(75199);const b=[{path:"",component:c,children:[{path:"home",component:f},{path:"miscellaneous",loadChildren:()=>Promise.resolve().then(n.bind(n,44519)).then(e=>e.MiscellaneousModule)},{path:"composicion",loadChildren:()=>Promise.resolve().then(n.bind(n,54779)).then(e=>e.ComposicionModule),canActivate:[Z.a]},{path:"repositorio",loadChildren:()=>Promise.resolve().then(n.bind(n,24157)).then(e=>e.RepositorioModule),canActivate:[Z.a]},{path:"profile",loadChildren:()=>n.e(257).then(n.bind(n,86257)).then(e=>e.ProfileModule),canActivate:[Z.a]},{path:"admin",loadChildren:()=>n.e(935).then(n.bind(n,75935)).then(e=>e.AdminModule),canActivate:[Z.a]},{path:"",redirectTo:"home",pathMatch:"full"},{path:"**",component:l.w}]}];let v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[s.Bz.forChild(b)],s.Bz]}),e})();var T=n(44519),A=n(24157),q=n(54779),y=n(10352);let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[v,i.j5J,T.MiscellaneousModule,y.O,i.zyh,A.RepositorioModule,q.ComposicionModule,i.BW0]]}),e})()},24157:function(e,t,n){"use strict";n.r(t),n.d(t,{RepositorioModule:function(){return A}});var i=n(38583),s=n(99763),o=n(92340),r=n(37716),a=n(13030);let c=(()=>{class e{constructor(e){this.dialogRef=e}ngOnInit(){}downloadMusicXML(){window.location.href=`${o.N.apiUrl}/api/sheets/${this.sheet.id}/file/musicxml`,this.dialogRef.close()}downloadPDF(){window.location.href=`${o.N.apiUrl}/api/sheets/${this.sheet.id}/file/pdf`,this.dialogRef.close()}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.X4l))},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-download-dialog"]],inputs:{sheet:"sheet"},decls:14,vars:2,consts:[[1,"my-4"],["fullWidth","","nbButton","","status","primary",3,"disabled","click"],["icon","download-outline"]],template:function(e,t){1&e&&(r.TgZ(0,"nb-card"),r.TgZ(1,"nb-card-header"),r._uU(2,"Descargar partitura"),r.qZA(),r.TgZ(3,"nb-card-body"),r.TgZ(4,"p"),r._uU(5,"Elige un formato:"),r.qZA(),r.TgZ(6,"div",0),r.TgZ(7,"button",1),r.NdJ("click",function(){return t.downloadMusicXML()}),r._UZ(8,"nb-icon",2),r._uU(9," MusicXML "),r.qZA(),r.qZA(),r.TgZ(10,"div",0),r.TgZ(11,"button",1),r.NdJ("click",function(){return t.downloadPDF()}),r._UZ(12,"nb-icon",2),r._uU(13," PDF "),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(7),r.Q6J("disabled",!t.sheet.xml),r.xp6(4),r.Q6J("disabled",!t.sheet.pdf))},directives:[a.Asz,a.ndF,a.yKW,a.DPz,a.fMN],styles:["nb-card[_ngcontent-%COMP%]{min-width:300px}"]}),e})();var l=n(57322),u=n(3679),d=n(86665),p=n(20945);function h(e,t){1&e&&(r.TgZ(0,"span"),r._UZ(1,"nb-icon",1),r.qZA())}function g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span"),r._UZ(1,"nb-icon",2),r.TgZ(2,"button",3),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.retry(t.sheet.id)}),r._UZ(3,"nb-icon",4),r.qZA(),r.qZA()}}function m(e,t){1&e&&(r.TgZ(0,"span"),r._UZ(1,"em",5),r.qZA())}let f=(()=>{class e{constructor(e,t){this.sheetService=e,this.toastrService=t}ngOnInit(){this.refresher=(0,p.F)(2e3).subscribe(e=>this.refresh())}retry(e){this.sheetService.retry(this.sheet.id).subscribe(e=>{this.sheet.finished=!1,this.toastrService.success(e,"Tarea planificada")},e=>{this.toastrService.danger(e.error.message,"ERROR")})}refresh(){this.sheetService.getSheet(this.sheet.id).subscribe(e=>{e.finished&&(this.sheet=e,this.refresher.unsubscribe())})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(l.J),r.Y36(a.quB))},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-status"]],inputs:{sheet:"sheet"},decls:3,vars:3,consts:[[4,"ngIf"],["status","success","icon","checkmark-outline"],["status","danger","icon","alert-triangle-outline"],["nbButton","","ghost","","shape","round","nbTooltip","Reintentar",1,"mx-2",3,"click"],["icon","sync-outline"],[1,"fas","fa-sync","fa-spin"]],template:function(e,t){1&e&&(r.YNc(0,h,2,0,"span",0),r.YNc(1,g,4,0,"span",0),r.YNc(2,m,2,0,"span",0)),2&e&&(r.Q6J("ngIf",t.sheet.finished&&t.sheet.pdf&&t.sheet.xml&&t.sheet.specs),r.xp6(1),r.Q6J("ngIf",t.sheet.finished&&(!t.sheet.pdf||!t.sheet.xml||!t.sheet.specs)),r.xp6(1),r.Q6J("ngIf",!t.sheet.finished))},directives:[i.O5,a.fMN,a.DPz,a.jNv],styles:[""]}),e})();function Z(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"nb-list-item",6),r.TgZ(1,"span",7),r._uU(2),r.qZA(),r.TgZ(3,"span",7),r._uU(4),r.qZA(),r._UZ(5,"ngx-status",8),r.TgZ(6,"nb-actions",9),r.TgZ(7,"nb-action",10),r.NdJ("click",function(){const t=r.CHM(e).$implicit,n=r.oxw();return t.pdf?n.openNewTab(t.id):null}),r.qZA(),r.TgZ(8,"nb-action",11),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().openDownloadDialog(t)}),r.qZA(),r.TgZ(9,"nb-action",12),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().deleteSheet(t.id)}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.xp6(2),r.Oqu(e.name),r.xp6(2),r.Oqu(e.date),r.xp6(1),r.Q6J("sheet",e),r.xp6(2),r.Q6J("disabled",!e.pdf)}}const b=[{path:"",component:(()=>{class e{constructor(e,t,n,i,s,o){this.sheetService=e,this.formBuilder=t,this.nbDialogService=n,this.toastrService=i,this.dialogService=s,this.authService=o,this.userId=null,this.sheets=[],this.filteredSheets=[],this.loading=!1,this.authService.onTokenChange().subscribe(e=>{e.isValid()&&(this.userId=e.getPayload().id)}),this.busquedaForm=t.group({name:""})}ngOnInit(){this.sheetService.getSheets(void 0,void 0,this.userId).subscribe(e=>{this.sheets=e,this.loading=!1,this.filteredSheets.push(...this.sheets)},e=>{this.toastrService.danger(e.error.message,"ERROR")})}filterSheets(e){this.busquedaForm.valid&&(this.loading=!0,this.filteredSheets=this.sheets.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.loading=!1)}openDownloadDialog(e){this.dialogService.open(c,{context:{sheet:e}})}deleteSheet(e){this.sheetService.deleteSheet(e).subscribe(e=>{this.showToast("Partitura eliminada con \xe9xito!","\xc9xito","top-right","success"),this.sheetService.getSheets().subscribe(e=>{this.sheets=e,this.filterSheets("")},e=>{this.toastrService.danger(e.error.message,"ERROR")}),this.filterSheets("")},e=>{this.toastrService.danger(e.error.message,"ERROR")})}showToast(e,t,n,i){this.toastrService.show(e,t,{position:n,status:i})}openNewTab(e){window.open(`${o.N.apiUrl}/api/sheets/${e}.pdf`,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(l.J),r.Y36(u.qu),r.Y36(a.Gln),r.Y36(a.quB),r.Y36(a.Gln),r.Y36(d._o))},e.\u0275cmp=r.Xpm({type:e,selectors:[["ngx-repositorio"]],decls:11,vars:5,consts:[[1,"pb-4"],[3,"formGroup","ngSubmit"],["nbInput","","formControlName","name","placeholder","Filtrar...",2,"width","300px",3,"keyup"],[1,"mx-5","text-secondary"],[3,"nbSpinner"],["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"col"],[1,"col",3,"sheet"],["size","small","disabled","!sheet.finished",1,"ml-auto"],["icon","eye-outline",3,"disabled","click"],["icon","download-outline",3,"click"],["icon","trash-2-outline",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"nb-card"),r.TgZ(1,"nb-card-header"),r._uU(2,"Repositorio"),r.qZA(),r.TgZ(3,"nb-card-body"),r.TgZ(4,"div",0),r.TgZ(5,"form",1),r.NdJ("ngSubmit",function(){return t.filterSheets(t.busquedaForm.value.name)}),r.TgZ(6,"input",2),r.NdJ("keyup",function(){return t.filterSheets(t.busquedaForm.value.name)}),r.qZA(),r.TgZ(7,"span",3),r._uU(8),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"nb-list",4),r.YNc(10,Z,10,4,"nb-list-item",5),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(5),r.Q6J("formGroup",t.busquedaForm),r.xp6(3),r.AsE("(",t.filteredSheets.length," resultados de ",t.sheets.length,")"),r.xp6(1),r.Q6J("nbSpinner",t.loading),r.xp6(1),r.Q6J("ngForOf",t.filteredSheets))},directives:[a.Asz,a.ndF,a.yKW,u._Y,u.JL,u.sg,a.h8i,u.Fj,u.JJ,u.u,a.zP_,a.Q7R,i.sg,a.qBV,f,a.lYD,a.Bk3],styles:["mat-spinner[_ngcontent-%COMP%]{display:inline}nb-list[_ngcontent-%COMP%]{overflow:hidden}"]}),e})()}];let v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[s.Bz.forChild(b)],s.Bz]}),e})();var T=n(73749);let A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[i.ez,v,u.u5,u.UX,T.$,a.KdK,a.COg,a.zyh,a.j7H,a.uuI,a.MAY,a.HKp,a.T2N,a.rgH,a.spT,a.nKr]]}),e})()}}]);